<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Talk 2Me Nice</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
:root {
  --bg-main: linear-gradient(160deg, #1b1f27 0%, #2a2f3b 100%);
  --bg-card: #2c313d;
  --accent: #ffb86c;
  --text-main: #e1e4ea;
  --text-muted: #a1a6b0;
}

/* General Layout */
body{margin:0;font-family:'Montserrat',sans-serif;background:var(--bg-main);color:var(--text-main);display:flex;flex-direction:column;min-height:100vh;}
h3,h4{font-family:'Playfair Display',serif;}
button{font-family:'Montserrat',sans-serif;}
.hidden{display:none;}
#landingPage,#chatContainer{max-width:900px;margin:2rem auto;display:flex;flex-direction:column;gap:1rem;}
input,select{font-family:'Montserrat',sans-serif;}

/* Landing Page */
#landingPage input{padding:0.6rem;border-radius:12px;border:none;background:#1f232d;color:var(--text-main);margin-bottom:1rem;width:100%;}
#landingPage button{padding:0.6rem 1rem;border-radius:999px;border:none;background:var(--accent);cursor:pointer;transition:all 0.3s ease;width:100%;}
#landingPage button:hover{transform:scale(1.05);background:#ff9f40;}
#logoLanding{font-family:'Playfair Display';font-size:2rem;text-align:center;color:var(--accent);margin-bottom:1rem;}

/* Companion selector */
#companionSelector h3{text-align:center;color:var(--accent);margin-bottom:1rem;}
.companionGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:1rem;}
.companionCard{background:var(--bg-card);border-radius:14px;padding:1rem;cursor:pointer;text-align:center;transition:all 0.25s ease;border:2px solid transparent;}
.companionCard h4{margin:0;}
.companionCard p{font-size:0.85rem;color:var(--text-muted);margin-top:0.4rem;}
.companionCard small.preview{display:block;margin-top:0.5rem;font-size:0.75rem;color:var(--text-muted);font-style:italic;}
.companionCard:hover{transform:translateY(-4px);box-shadow:0 8px 18px rgba(0,0,0,0.35);}
.companionCard.active{border-color:var(--accent);box-shadow:0 0 0 2px rgba(255,184,108,0.25);}

/* Chat Page */
#chatContainer{flex-direction:row;display:flex;gap:1rem;animation:fadeIn 0.8s ease-out;}
#profileSidebar{width:220px;padding:1rem;background:var(--bg-card);border-radius:16px;flex-shrink:0;display:flex;flex-direction:column;gap:1rem;box-shadow:0 6px 16px rgba(0,0,0,0.3);}
#starterBox{margin:1rem 0;padding:0.8rem;background:#1f232d;border-radius:12px;cursor:pointer;transition: transform 0.2s;}
#starterBox:hover{transform:scale(1.03);}
#starterTitle{font-weight:600;margin:0.5rem 0;color:#ffb86c;text-align:center;}
#chatArea{flex:1;display:flex;flex-direction:column;background:var(--bg-card);border-radius:16px;padding:1rem;box-shadow:0 6px 16px rgba(0,0,0,0.25);}
.message{max-width:75%;padding:0.8rem 1.2rem;margin-bottom:0.7rem;border-radius:20px;line-height:1.5;opacity:0;animation:fadeInMessage 0.5s forwards;}
.user{background:var(--accent);color:#1b1f27;align-self:flex-end;}
.bot{background:var(--bg-card);align-self:flex-start;}
footer{display:flex;flex-wrap:wrap;padding:0.8rem;gap:0.5rem;position:sticky;bottom:0;background:var(--bg-main);}
footer input{flex:1;padding:0.6rem;border-radius:12px;border:none;background:#1f232d;color:var(--text-main);}
footer button{padding:0.6rem 1rem;border-radius:999px;border:none;background:var(--accent);cursor:pointer;transition:all 0.3s ease;}
footer button:hover{transform:scale(1.05);background:#ff9f40;}
#micBtn{border-radius:50%;width:42px;height:42px;font-size:1.2rem;background:var(--accent);border:none;cursor:pointer;}
#micBtn.listening{animation:pulse 1.2s infinite;}
#micBtn.disabled{opacity:0.4;cursor:not-allowed;}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
@keyframes fadeInMessage{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,184,108,0.6);}70%{box-shadow:0 0 0 12px rgba(255,184,108,0);}100%{box-shadow:0 0 0 0 rgba(255,184,108,0);}}
#voiceSettings{background:var(--bg-card);padding:1rem;border-radius:14px;margin-top:1rem;font-size:0.85rem;}
#voiceSettings h4{margin-top:0;color:var(--accent);}
#voiceSettings label{display:flex;align-items:center;justify-content:space-between;margin-bottom:0.6rem;gap:0.5rem;}

/* Gear / Options Icon */
#gearBtn{cursor:pointer;font-size:1.4rem;color:var(--accent);align-self:flex-end;margin-bottom:0.5rem;}

/* Onboarding */
#onboarding{position:fixed;inset:0;background:rgba(0,0,0,0.65);display:flex;align-items:center;justify-content:center;z-index:999;}
.onboardCard{background:var(--bg-card);padding:2rem;border-radius:18px;max-width:360px;text-align:center;}
.onboardCard h3{color:var(--accent);}
.onboardCard button{margin-top:1rem;padding:0.6rem 1.4rem;border-radius:999px;border:none;background:var(--accent);cursor:pointer;}
</style>
</head>
<body>

<!-- Landing Page -->
<div id="landingPage">
  <div id="logoLanding">Talk 2Me Nice</div>
  <input id="nicknameInput" placeholder="Enter your nickname" />
  <div id="companionSelector">
    <h3>Choose Your Companion</h3>
    <div class="companionGrid">
      <div class="companionCard" data-companion="Whisp"><h4>Whisp</h4><p>Gentle, supportive, calm</p><small class="preview">‚ÄúI‚Äôm here with you. Take your time.‚Äù</small></div>
      <div class="companionCard" data-companion="Robot"><h4>Robot</h4><p>Confident, playful, witty</p><small class="preview">‚ÄúSystems online. Ready to chat.‚Äù</small></div>
      <div class="companionCard" data-companion="Star"><h4>Star</h4><p>Shiny, strong, motivational</p><small class="preview">‚ÄúShine bright today!‚Äù</small></div>
      <div class="companionCard" data-companion="Cloud"><h4>Cloud</h4><p>Soft, calming, whimsical</p><small class="preview">‚ÄúRelax and enjoy the day.‚Äù</small></div>
    </div>
  </div>
  <select id="languageSelect">
    <option value="en-US">English</option>
    <option value="es-ES">Spanish</option>
    <option value="fr-FR">French</option>
    <option value="de-DE">German</option>
  </select>
  <button onclick="startChat()">Start Chat</button>
</div>

<!-- Chat Page -->
<div id="chatContainer" class="hidden">
  <div id="profileSidebar">
    <div id="gearBtn">‚öôÔ∏è</div>
    <div class="profileInfo">
      <p>üë§ <strong id="profileName"></strong></p>
      <p>üåç <span id="profileLanguage"></span></p>
      <p>üßö <span id="profileCompanion"></span></p>
    </div>
    <hr>
    <p id="starterTitle">Conversation Starters</p>
    <select id="starterDropdown" onchange="startStarter()"><option value="">-- Select Starter --</option></select>
    <div id="voiceSettings">
      <h4>Voice Settings</h4>
      <label><input type="checkbox" id="voiceOutputToggle" checked> Voice replies</label>
      <label><input type="checkbox" id="voiceInputToggle" checked> Voice input</label>
      <label>Speech speed
        <select id="voiceSpeed">
          <option value="0.9">Slow</option>
          <option value="1" selected>Normal</option>
          <option value="1.1">Fast</option>
        </select>
      </label>
    </div>
    <hr>
    <div><a href="#" onclick="returnToChat()">Privacy</a> | <a href="#" onclick="returnToChat()">Support</a></div>
  </div>
  <div id="chatArea"><div id="chat"></div></div>
</div>

<footer class="hidden">
  <input id="userInput" placeholder="Type a message‚Ä¶" />
  <button id="micBtn" onclick="startSpeechToSpeech()">üé§</button>
  <button onclick="sendMessage()">Send</button>
</footer>

<script>
// ----- Companion Definitions -----
const companions={
  Whisp:{name:"Whisp",voice:{input:true,output:true},systemPrompt:"Gentle and calm."},
  Robot:{name:"Robot",voice:{input:true,output:true},systemPrompt:"Confident and playful."},
  Star:{name:"Star",voice:{input:true,output:true},systemPrompt:"Motivational."},
  Cloud:{name:"Cloud",voice:{input:true,output:true},systemPrompt:"Soft and calming."}
};

// ----- Landing Page -----
const companionCards=document.querySelectorAll(".companionCard");
const nicknameInput=document.getElementById("nicknameInput");
const languageSelect=document.getElementById("languageSelect");
let selectedCompanion="Whisp";

companionCards.forEach(card=>card.addEventListener("click",()=>{
  companionCards.forEach(c=>c.classList.remove("active"));
  card.classList.add("active");
  selectedCompanion=card.dataset.companion;
}));

languageSelect.addEventListener("change",()=>localStorage.setItem("lockedLanguage",languageSelect.value));

function startChat(){
  if(!nicknameInput.value.trim()){alert("Enter a nickname");return;}
  localStorage.setItem("nickname",nicknameInput.value.trim());
  localStorage.setItem("companion",selectedCompanion);
  localStorage.setItem("language",localStorage.getItem("lockedLanguage")||"en-US");
  document.getElementById("landingPage").classList.add("hidden");
  document.getElementById("chatContainer").classList.remove("hidden");
  document.querySelector("footer").classList.remove("hidden");
  document.getElementById("profileName").textContent=nicknameInput.value.trim();
  document.getElementById("profileCompanion").textContent=selectedCompanion;
  document.getElementById("profileLanguage").textContent=localStorage.getItem("language");
  populateStarters();
  sendDailyWelcome();
}

// ----- Conversation Starters -----
const conversationStarters={
  Workplace:["Good morning! How's your day?"],
  Travel:["Where is the nearest train station?"],
  School:["Hello! How was class today?"]
};

function populateStarters(){
  const dd=document.getElementById("starterDropdown");
  dd.innerHTML=`<option value="">-- Select Starter --</option>`;
  Object.keys(conversationStarters).forEach(cat=>{
    const today=new Date().getDate();
    const phrases=conversationStarters[cat];
    const phrase=phrases[today%phrases.length]; // rotate daily
    const opt=document.createElement("option"); opt.value=phrase; opt.textContent=`${cat}: ${phrase}`;
    dd.appendChild(opt);
  });
}
function startStarter(){const val=document.getElementById("starterDropdown").value;if(val)sendMessage(val);}

// ----- Daily Welcome -----
function sendDailyWelcome(){
  const nickname=localStorage.getItem("nickname");
  const companionId=localStorage.getItem("companion");
  const language=localStorage.getItem("lockedLanguage")||"en-US";
  const greetings={
    Whisp:[`Good morning, ${nickname}! üå∏`],
    Robot:[`Hello ${nickname}, systems online.`],
    Star:[`Shine bright today, ${nickname}! ‚≠ê`],
    Cloud:[`Hi ${nickname}, relax and enjoy the day ‚òÅÔ∏è`]
  };
  const today=new Date().toDateString();
  const key=`welcome_${companionId}`;
  let stored=JSON.parse(localStorage.getItem(key))||{};
  let msg;
  if(stored.date===today)msg=stored.phrase;
  else{
    msg=greetings[companionId][0];
    localStorage.setItem(key,JSON.stringify({date:today,phrase:msg}));
  }
  showTyping(msg,language);
}

// ----- Chat Functions -----
const chat=document.getElementById("chat");
function addMessage(text,sender){const div=document.createElement("div");div.className=`message ${sender}`;div.textContent=text;chat.appendChild(div);chat.scrollTop=chat.scrollHeight;}
function showTyping(text,lang){let i=0;const div=document.createElement("div");div.className="message bot";chat.appendChild(div);function type(){if(i<text.length){div.textContent+=text[i];i++;setTimeout(type,20);}else{speakBotText(text,lang);chat.scrollTop=chat.scrollHeight;}}type();}
function speakBotText(text,lang){if(!window.speechSynthesis)return;const utter=new SpeechSynthesisUtterance(text);utter.lang=lang;utter.rate=1;window.speechSynthesis.speak(utter);}
async function sendMessage(msg=null){const input=document.getElementById("userInput");const text=msg||input.value.trim();if(!text)return;addMessage(text,"user");input.value="";await new Promise(r=>setTimeout(r,500));showTyping(`Echo: ${text}`,localStorage.getItem("lockedLanguage")||"en-US");}

// ----- Voice Input -----
const micBtn=document.getElementById("micBtn");
function startSpeechToSpeech(){const recognition=new (window.SpeechRecognition||window.webkitSpeechRecognition)();recognition.lang=localStorage.getItem("lockedLanguage")||"en-US";recognition.interimResults=false;recognition.continuous=false;micBtn.classList.add("listening");recognition.onresult=(e)=>{const spoken=e.results[0][0].transcript;sendMessage(spoken);};recognition.onend=()=>{micBtn.classList.remove("listening");};recognition.start();}
function returnToChat(){document.getElementById("privacySupport").classList.add("hidden");document.getElementById("chatContainer").classList.remove("hidden");}
</script>

</body>
</html>
